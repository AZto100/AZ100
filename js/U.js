window.scrollTo(0,0),window.onbeforeunload=function(){window.scrollTo(0,0)};var loadAgain=0,filenr=0,examplefiletoload=document.getElementById("ExampleB").value;function loadJS(e,t=!0){document.getElementById("remove").remove();var n=document.createElement("script");n.setAttribute("src",e),n.setAttribute("type","text/javascript"),n.setAttribute("async",t),n.setAttribute("id","remove"),document.body.appendChild(n),n.addEventListener("load",()=>{console.log("File loaded"),forwardEC(),backwardEC()}),n.addEventListener("error",e=>{console.log("Error on loading file",e)})}function loadExampleFile(e){switch(console.log(e),e){case"Week2":loadJS("js/week2.js",!0);break;case"Week3":loadJS("js/week3.js",!0);break;case"Vat incl.":day="Tuesday";break;case"Manufacturing":day="Wednesday";break;case"Depreciation":loadJS("js/depreciation.js",!0);break;case"Interest":day="Friday";break;case"Compound1":loadJS("js/compound1.js",!0)}}const cashList=["Net Income","<b>Additions to cash","Depreciation","Increase in accounts payable","<b>Subtractions from cash","Increase in accounts receivable","Increase in RM,WIP+inventory","<u><b>Net cash from operations","<b>Cash flow from investing","Purchases","<b>Cash flow from financing","Increases in liabilities+equity","<b><u>Cash flow for end of period"],Mname2=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Mname=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var accountTotals=[],accountTotalsEOP=[];for(let e=0;e<166;e++)accountTotals[e]=0,accountTotalsEOP[e]=0;var EC=0,CurRa=0,QuiRa=0,NDSiR=0,accLedger="",DebitList=[],CreditList=[],AmountList=[],DateList=[],DescriptionList=[],ClassList=[],ReferenceList=[],SourceList=[],NumberOfTransactions=0,PreviousRetained=0,PreviousTrans=1,arrB=[],B10=[1,2,4,6,10,11,13,14,16,18,20,22,26],B10L=B10.length;const L1=[128,129,130,131,132,133,134,135];var L1L=L1.length+B10L;const O1=[137,138,139,140,145,146];var O1L=O1.length+L1L;const I1=[147,149,153,154,155,156,157,159,160,161,163,164,165];var I1L=I1.length+O1L;const A1=[4,6,10,11,13,14,16,18,20,22,26,130,131,132,133,135,139,140,145,147,149,151,154,155,157,160,161,164],B1=B10.concat(L1,O1,I1);var ledger=document.getElementById("Ledger"),cash=document.getElementById("cashState"),marsDef=[827771747,2341054634,105622804,2617105775,245302392,2045383537,3435167171,111593204,1505412291,486998347,2745745127,4159517930,119955338,3669349494,411330989,3471601104,4151982214,678642177,2326703863,462555332,3625079464,2970249216,2301841961,2880131819,3900754222,1272164993,284333386,206586687,3480003957,115926365,3201281333,3403231598,4226589798,2354930228,312523050,3322010382,3214440454,161720024,4291408975,163725807,1092017427,3009903153,646563511,421593311,2103629345,3852276432,3798462540,1058910848,1322445340,3153488839,373501404,3685607396,757496071,2825214814,2132275844,3202398442,2886061492,2657077192,200354245,2215535296,3790166821,2605008669,2518629333,787835523,643346350,580951925,2451323717,1501511402,296783199,1160074035,958434163,2439628516,456113080,3567330205,3952038610,1511760192,3291532986,192134113,2076991862,1805113932,2148802298,3339548632,1794797284,2923421282,1065537421,3857534592,352705580,1307187844,1197208612,980186538,2210089733,3996858687,405274208,3738339685,4273293883,2255790325,1922085471,4286680776,2005271899,3042088642,652631839,3474248077,1896847403,101097770,700390851,3715535448,2179424781,3750458330,4168817347,2725562336,2650138532,308833573,1852243246,895058198,2993708600,313536923,3178933117,2569207332,944049094,2522531135,3053587848,1609666213,2313843360,4222098515,424576926,3753333311,4162162478,1494286356,1421582167,445841222,3233118688,857745432,174418834,3848192898,548725018,3004430939,3295948497,2567833185,3803836027,3254464472,3097261759,3328029323,1898039904,37597098,2601983032,3233950479,929565872,301808768,3695764603,468413240,1190761847,767560986,3950842880,3363474681,1372228591,3420587987,2968324217,2772180437,2418233560,1891575696,461563522,4126078577,493760381,3186152934,634134879,2095467719];let statementsAccounts={1:"<b>TOTAL ASSETS</b>",2:"<b>CURRENT ASSETS</b>",3:"Cash",4:"Bank",5:"Prepaid Expenses",6:"Input VAT",7:"Payroll fund",8:"Dividend fund",9:"Tax fund",10:"Pre-paid Expense",11:"Raw Material",12:"Raw Material 2",13:"WIP Inventory",14:"Merchandise+Trade inventory",15:"Trade Inventory-2",16:"Accounts Receivable",18:"<b>NON-CURRENT ASSETS</b>",19:"Plant Property and Equipment",20:"Land and Buildings",21:"Building",22:"Machinery Vehicles and Equipment",23:"Vehicles",24:"Office Equipment",25:"Furniture and fixtures",26:"Accumulated depreciation",27:"Long-term loan to:",128:"<b>TOTAL LIABILITIES",129:"<b>CURRENT LIABILITIES</b>",130:"Accounts Payable",131:"Vat Payable",132:"Pre-paid Revenues",133:"Tax Payable",134:"<b>NON-CURRENT LIABILITIES</b>",135:"Long term loans",136:"Hire-Purchase",137:"<b>OWNER'S EQUITY(inc.Retained)",138:"<b>CAPITAL</b>",139:"Jamey Contribution",140:"Susan Contribution",141:"Jay",142:"Jack",143:"Jill",144:"Dividend to be paid",145:"Retained Earnings",146:"<b>TOTAL LIABILITIES & OWNER'S EQUITY</b>",147:"Sales or Revenues",148:"Sales Returns",149:"COGS",150:"COGR",151:"Discounts Allowed",152:"Discounts Recieved",153:"GROSS PROFIT",154:"Other Income",155:"Other Expenses",156:"EBITDA",157:"Depreciation",158:"Amortisation",159:"EBIT",160:"Interest paid",161:"Interest received",162:"Interest Balance",163:"EBT",164:"Tax",165:"NET PROFIT",166:"Dividends paid"};function enableEnter(e){13==e.keyCode&&(e.preventDefault(),editRow(0),showR1())}$(document).ready(function(){$(".resizedTextbox").keypress(function(e){enableEnter(e)})});var mySelect=document.getElementById("TAcc"),y=document.getElementById("showHide2"),inputText="Show T-Account Ledger(select an account)";for(mySelect.onchange=(e=>{void 0===(inputText=e.target.value)?(inputText="Show T-Account Ledger(select an account)",y.innerHTML=inputText):y.innerHTML="Show "+inputText+" Ledger (T-account)"}),row=0;row<35;row++){let e=document.createElement("tr");for(cell=0;cell<6;cell++)td=document.createElement("td"),e.appendChild(td),0==cell&&(td.style.width="10px"),1==cell&&(td.style.width="20px"),cell>1&&(td.style.width="20px");ledger.appendChild(e),ledger.rows[row].cells[0].innerHTML=row}for(ledger.rows[0].cells[0].innerHTML="Index",ledger.rows[0].cells[1].innerHTML="............Debit",ledger.rows[0].cells[2].innerHTML="...........Credit",ledger.rows[0].cells[3].innerHTML="........Balance",ledger.rows[0].cells[4].innerHTML="Date",ledger.rows[0].cells[5].innerHTML="Description",row=0;row<14;row++){let e=document.createElement("tr");for(cell=0;cell<3;cell++)td=document.createElement("td"),e.appendChild(td),0==cell&&(td.style.width="70px",td.classname="leftAlign"),1==cell&&(td.style.width="40px"),cell>1&&(td.style.width="40px");cash.appendChild(e),cash.rows[row].cells[0].innerHTML=row}for(cash.rows[0].cells[0].innerHTML="Cash flow from operations",cash.rows[0].cells[1].innerHTML="------------Debit",cash.rows[0].cells[2].innerHTML="+++++++Credit",row=1;row<14;row++)cash.rows[row].cells[0].innerHTML=cashList[row-1];function myrow2(e){e=e}var reader=new FileReader,csv=document.getElementById("email").value,picker=document.getElementById("loadTransactions"),exam=document.getElementById("Example"),showR=document.getElementById("showRatios1");showR.style.display,(showR=document.getElementById("showRatios2")).style.display;var Exe=document.getElementById("showExe1");Exe.style.display;var rIndex2,ctx=document.getElementById("myChart1"),ctx2=document.getElementById("myChart2"),table0=document.getElementById("balanceSheet"),tableAssets=document.getElementById("assets"),tableIS=document.getElementById("incomeStatement"),tableLiab=document.getElementById("liabilities"),tableOE=document.getElementById("owners"),NumShow=1,d1=new Date;if("object"==typeof(d1=new Date)&&null!==d1&&"getDate"in d1)var D31=d1.getDate(),M12=Mname2[d1.getMonth()],Y2000=d1.getFullYear();document.getElementById("Date").innerHTML=D31+" "+M12+" "+Y2000;var w=window.innerWidth,ww=Math.floor(w/12),flagShowI=0;function showIndex(){loadAgain=0,emptyTablesA(),loadOrNot();var e=document.getElementById("showIndx").value;let t=parseInt(e);tableGJournal.rows[t].scrollIntoView({block:"center"})}function resetAccounts(){for(let e=0;e<166;e++)accountTotals[e]=0,accountTotalsEOP[e]=0}function resetRest(){for(let e=0;e<200;e++)DebitList[e]="",CreditList[e]="",AmountList[e]=0,DateList[e]="",DescriptionList[e]="",ClassList[e]="",ReferenceList[e]="",SourceList[e]="";NumberOfTransactions=0,PreviousRetained=0,PreviousTrans=1,arrB=[]}function loadOrNot(){0==loadAgain?(loadAgain=1,resetAccounts(),resetRest(),reader.readAsText(picker.files[filenr])):(resetAccounts(),resetRest(),emptyTablesB(),reader.readAsText(picker.files[filenr]))}picker.onchange=(()=>loadOrNot()),reader.onloadend=(()=>{loadAgain=1,resetAccounts(),resetRest();let e=1;for(let t of CSV.parse(reader.result)){if("Index"!=t[0]){for(let n of t)2==e&&(AmountList[t[0]]=n),3==e&&(DebitList[t[0]]=n),4==e&&(CreditList[t[0]]=n),5==e&&(DateList[t[0]]=n),6==e&&(DescriptionList[t[0]]=n),7==e&&(ClassList[t[0]]=n),8==e&&(ReferenceList[t[0]]=n),9==e&&(SourceList[t[0]]=n),e+=1;e=0,1,editRow4Real(1,t[0])}e=1}});var rows=200,columns=3;tableAssets.innerHTML="";for(let e of B10){arrB[e]=[];for(let t=0;t<columns;t++)arrB[e][t]=t;arrB[e][1]=statementsAccounts[2][e]}let tr=tableAssets.insertRow();for(let e=1;e<4;e++){let t=tr.insertCell();t.style.width=ww+"px",1==e&&(t.innerHTML="ACCOUNT NAMES"),2==e&&(t.innerHTML="++++DEBIT++++"),3==e&&(t.innerHTML="-------CREDIT------")}for(let e of B10){let t=tableAssets.insertRow();for(let n=1;n<4;n++){let o=t.insertCell();o.style.width=ww+"px",o.innerHTML="",1==n&&(o.style.width=ww+"px",1==e&&(o.innerHTML=statementsAccounts[e],arrB[e][n]=o.innerHTML),2==e&&(o.innerHTML="&nbsp"+statementsAccounts[e],arrB[e][n]=o.innerHTML),e>2&e<18&&(o.innerHTML="&nbsp &nbsp"+statementsAccounts[e],arrB[e][n]=o.innerHTML),18==e&&(o.innerHTML="&nbsp"+statementsAccounts[e],arrB[e][n]=o.innerHTML),e>18&&(o.innerHTML="&nbsp &nbsp"+statementsAccounts[e],arrB[e][n]=o.innerHTML))}}tableLiab.innerHTML="";for(let e of L1){arrB[e]=[];for(let t=0;t<columns;t++)arrB[e][t]=t;arrB[e][1]=statementsAccounts[2][e]}tr=tableLiab.insertRow();for(let e=1;e<4;e++){let t=tr.insertCell();t.style.width=ww+"px",1==e&&(t.innerHTML="ACCOUNT NAMES"),2==e&&(t.innerHTML="---------DEBIT------"),3==e&&(t.innerHTML="+++CREDIT++++")}for(let e of L1){tr=tableLiab.insertRow();for(let t=1;t<4;t++){let n=tr.insertCell();n.style.width=ww+"px",n.innerHTML="",1==t&&(n.style.width=ww+"px",128==e&&(n.innerHTML=statementsAccounts[e],arrB[e][t]=n.innerHTML),129==e&&(n.innerHTML="&nbsp"+statementsAccounts[e],arrB[e][t]=n.innerHTML),e>129&e<134&&(n.innerHTML="&nbsp &nbsp"+statementsAccounts[e],arrB[e][t]=n.innerHTML),134==e&&(n.innerHTML="&nbsp"+statementsAccounts[e],arrB[e][t]=n.innerHTML),e>134&&(n.innerHTML="&nbsp &nbsp"+statementsAccounts[e],arrB[e][t]=n.innerHTML))}}tableOE.innerHTML="";for(let e of O1){arrB[e]=[];for(let t=0;t<columns;t++)arrB[e][t]=t;arrB[e][1]=statementsAccounts[2][e]}tr=tableOE.insertRow();for(let e=1;e<4;e++){let t=tr.insertCell();t.style.width=ww+"px",1==e&&(t.innerHTML="ACCOUNT NAMES"),2==e&&(t.innerHTML="---------DEBIT------"),3==e&&(t.innerHTML="+++CREDIT++++")}for(let e of O1){tr=tableOE.insertRow();for(let t=1;t<4;t++){let n=tr.insertCell();n.style.width=ww+"px",n.innerHTML="",1==t&&(n.innerHTML=statementsAccounts[e]),arrB[e][t]=n.innerHTML}}tableIS.innerHTML="";var arrI=[];let rowsI=I1.length+1;for(let e of I1){arrI[e]=[];for(let t=0;t<columns;t++)arrI[e][t]=t;arrI[e][1]=statementsAccounts[2][e]}tr=tableIS.insertRow();for(let e=1;e<4;e++){let t=tr.insertCell();t.style.width=ww+"px",1==e&&(t.innerHTML="ACCOUNT"),2==e&&(t.innerHTML="-------DEBIT------"),3==e&&(t.innerHTML="++++CREDIT++++")}for(let e of I1){let t=tableIS.insertRow();for(let n=1;n<4;n++){let o=t.insertCell();o.style.width=ww+"px",o.innerHTML="",1==n&&(o.innerHTML=statementsAccounts[e]),arrI[e][n]=o.innerHTML}}tableIS.rows[0].cells[1].innerHTML="DEBIT",tableIS.rows[0].cells[2].innerHTML="CREDIT";for(var Accounts1="",i=0;i<A1.length;i++){Accounts1+='<option value="'+statementsAccounts[x=A1[i]]+'">'+statementsAccounts[x]+"</option>"}document.getElementById("TAcc").innerHTML=Accounts1,document.getElementById("Debit").innerHTML=Accounts1,document.getElementById("Credit").innerHTML=Accounts1;let examplesAcc=["Week2","Week3","Vat incl.","Manufacturing","Depreciation","Interest","Compound1","Compound2","Compound3","Compound4"];var Examples1="";for(i=0;i<examplesAcc.length;i++){var x;Examples1+='<option value="'+(x=examplesAcc[i])+'">'+x+"</option>"}document.getElementById("ExampleB").innerHTML=Examples1;var monthOptions="";for(i=1;i<13;i++)monthOptions+='<option value="'+i+'">'+i+"</option>";function exportPdfT(){var e=new jsPDF;e.text(40,20,accLedger+" T-account"),e.autoTable({html:"#Ledger",startY:25,theme:"grid",columnStyles:{0:{cellWidth:12},1:{cellWidth:20},2:{cellWidth:20},3:{cellWidth:20},1:{halign:"right"},2:{halign:"right"},3:{halign:"right"},4:{cellWidth:40}},bodyStyles:{lineColor:[1,1,1]},styles:{minCellHeight:4}}),window.open(URL.createObjectURL(e.output("blob")))}function exportPdfA(){let e=document.getElementById("Company").value,t=document.getElementById("date").value,n=document.getElementById("password").value;var o=new jsPDF;o.text(20,20,"Statement of financial position of "+e+" on "+t+" by:"+n),o.autoTable({html:"#assets",startY:25,theme:"grid",columnStyles:{0:{minCellWidth:70},1:{halign:"right"},2:{halign:"right"}},bodyStyles:{lineColor:[1,1,1]},styles:{minCellHeight:4}}),o.autoTable({html:"#liabilities",startY:130,theme:"grid",columnStyles:{0:{minCellWidth:70},1:{halign:"right"},2:{halign:"right"}},bodyStyles:{lineColor:[1,1,1]},styles:{minCellHeight:4}}),o.autoTable({html:"#owners",startY:200,theme:"grid",columnStyles:{0:{minCellWidth:70},1:{halign:"right"},2:{halign:"right"}},bodyStyles:{lineColor:[1,1,1]},styles:{minCellHeight:4}}),window.open(URL.createObjectURL(o.output("blob")))}function exportPdfI(){let e=document.getElementById("Company").value,t=document.getElementById("period").value;var n=new jsPDF;n.text(20,20,"Income Statement of "+e+" during "+t),n.autoTable({html:"#incomeStatement",startY:25,theme:"grid",columnStyles:{0:{minCellWidth:70},1:{halign:"right"},2:{halign:"right"}},bodyStyles:{lineColor:[1,1,1]},styles:{minCellHeight:4}}),window.open(URL.createObjectURL(n.output("blob")))}function exportPdfGJ(){let e=document.getElementById("Company").value,t=document.getElementById("date").value;document.getElementById("GeneralJournaldiv");for(let e=0;e<NumberOfTransactions;e++)for(let e=4;e<9;e++);var n=new jsPDF;n.text(20,20,"General Journal "+e+" on "+t),n.autoTable({html:"#GeneralJournal",startY:25,theme:"grid",columnStyles:{1:{CellWidth:400},1:{halign:"right"},2:{halign:"right"}},bodyStyles:{lineColor:[1,1,1]},styles:{minCellHeight:4}}),window.open(URL.createObjectURL(n.output("blob")))}function showHash(){csv=document.getElementById("email").value,name=document.getElementById("password").value,""!=name&&""!=csv||alert("You need a valid email and password to get a valid HASH. Without a valid HASH the app is limited to Basic transactions. While waiting for your registration, you may use 'Guest' in the email field to access the basic examples.")}function endPeriod(){1==confirm("If you OK this, the Income Statement will be cleared for the next period transactions. If you would like to continue with the current period, click Cancel.")&&endPeriodAccounts()}function ledger2(e){const t=e;for(var n=0,o=1;o<999;o++)t==statementsAccounts[o]&&(n=o);for(let e=1;e<35;e++)for(let t=0;t<6;t++)ledger.rows[e].cells[t].innerHTML="";var a=1,l=0;myrowI>0&&(NumShow=myrowI),0==myrowI&&(NumShow=NumberOfTransactions),NumShow=NumberOfTransactions;for(let t=1;t<NumShow;t++)AmountList2=n<99?AmountList[t]:-AmountList[t],n<99?(DebitList[t]==e&&(ledger.rows[a].cells[4].innerHTML=DateList[t],ledger.rows[a].cells[5].innerHTML=DescriptionList[t],ledger.rows[a].cells[0].innerHTML=Number(t).toFixed(0),ledger.rows[a].cells[1].innerHTML=number_format(AmountList2/100,2,"."," "),ledger.rows[a].cells[2].innerHTML=CreditList[t],l+=AmountList2,ledger.rows[a].cells[3].innerHTML=number_format(l/100,2,"."," "),a+=1),CreditList[t]==e&&(ledger.rows[a].cells[4].innerHTML=DateList[t],ledger.rows[a].cells[5].innerHTML=DescriptionList[t],ledger.rows[a].cells[0].innerHTML=Number(t).toFixed(0),ledger.rows[a].cells[2].innerHTML=number_format(AmountList2/100,2,"."," "),ledger.rows[a].cells[1].innerHTML=DebitList[t],l-=AmountList2,ledger.rows[a].cells[3].innerHTML=number_format(l/100,2,"."," "),a+=1)):(DebitList[t]==e&&(ledger.rows[a].cells[4].innerHTML=DateList[t],ledger.rows[a].cells[5].innerHTML=DescriptionList[t],ledger.rows[a].cells[0].innerHTML=Number(t).toFixed(0),ledger.rows[a].cells[1].innerHTML=number_format(-AmountList2/100,2,"."," "),ledger.rows[a].cells[2].innerHTML="",l+=AmountList2,ledger.rows[a].cells[3].innerHTML=number_format(l/100,2,"."," "),a+=1),CreditList[t]==e&&(ledger.rows[a].cells[4].innerHTML=DateList[t],ledger.rows[a].cells[5].innerHTML=DescriptionList[t],ledger.rows[a].cells[0].innerHTML=Number(t).toFixed(0),ledger.rows[a].cells[2].innerHTML=number_format(-AmountList2/100,2,"."," "),ledger.rows[a].cells[1].innerHTML="",l-=AmountList2,ledger.rows[a].cells[3].innerHTML=number_format(l/100,2,"."," "),a+=1));ledger.rows[a].scrollIntoView({behavior:"smooth",block:"center"});for(let e=a;e<35;e++){for(let e=0;e<4;e++)ledger.rows[a].cells[e].innerHTML="";a+=1}}function showLedger(){document.getElementById("showLedger");ledger2(accLedger=document.getElementById("TAcc").value)}function showRatios(){console.log(DebitList);var e=document.getElementById("showRatios1");"none"==e.style.display||""==e.style.display?e.style.display="block":e.style.display="none","none"==(e=document.getElementById("showRatios2")).style.display||""==e.style.display?e.style.display="block":e.style.display="none";var t=document.getElementById("showHide1");"Show ratios"==t.innerHTML?t.innerHTML="Hide ratios":t.innerHTML="Show ratios",showR1(),showR2()}document.getElementById("Mon").innerHTML=monthOptions;var monthIS=1;function showR1(){monthIS=document.getElementById("Mon").value,CurRa=+accountTotals[1]/-accountTotals[129],QuiRa=+accountTotals[4]/-accountTotals[129],ARRa=12*-accountTotals[147]/monthIS/accountTotals[16],NDSir=365/ARRa,showRatios1.innerHTML="CURRENT RATIO = Current assets/Current liabilities<br>",showRatios1.innerHTML+="CURRENT RATIO = "+accountTotals[1]/100+"/"+-accountTotals[129]/100+" = "+Number(CurRa).toFixed(3),showRatios1.innerHTML+="<br>QUICK RATIO = Quick assets/Current liabilities",showRatios1.innerHTML+="<br>QUICK RATIO = "+accountTotals[4]/100+"/"+-accountTotals[129]/100+" = "+Number(QuiRa).toFixed(3),showRatios1.innerHTML+="<br><br>Set Months above for ART and NDSiR!",showRatios1.innerHTML+="<br><br>ART = Sales/Average accounts receivable",showRatios1.innerHTML+="<br>ART = "+-accountTotals[147]/100*12/monthIS+"/"+accountTotals[16]/100+" = "+Number(ARRa).toFixed(1),showRatios1.innerHTML+="<br>NDSiR = Accounts receivable/(Sales/365)",showRatios1.innerHTML+="<br>NDSiR = "+accountTotals[16]/100+"/("+-accountTotals[147]/100*12/monthIS+"/365) = ",showRatios1.innerHTML+=Number(365/ARRa).toFixed(1)}function showR2(){showRatios2.innerHTML="Liquidity ratios, CURRENT and QUICK RATIOS:<br>It measures the ability of a firm to pay its current liabilities with its cash and/or other current assets that can be converted to cash within a relatively short period of time.<br><br>ACCOUNTS RECEIVABLE TURNOVER (ART) measures the number of times the accounts receivable is collected in a year. The value of Months shown above is used as part of the calculation, and must be set correctly to the period of the income statement. Get it High!<br>NUMBER OF DAYS' SALES in RECEIVABLES (NDSiR)<br>Set Months above!  Make it Low..."}function showExe(){let e=Exe;"none"==e.style.display||""==e.style.display?e.style.display="block":e.style.display="none";var t=document.getElementById("showHideExe");"Exercise"==t.innerHTML?t.innerHTML="Hide Exercise":t.innerHTML="Exercise",showExe1.innerHTML=transEB1[EC]}function forwardEC(){EC<transEB1.length&&(EC+=1),showExe1.innerHTML=transEB1[EC]}function backwardEC(){EC>0&&(EC-=1),showExe1.innerHTML=transEB1[EC]}function newTransFunc(){var e=document.getElementById("amount").value;arrB[i][j]=e}function saveTransactions(){let e=document.getElementById("GeneralJournal");var t="Index,Amount,Debit,Credit,Date,Description,Class,Reference,Source\n",n=Math.max(mybackuprow,myrow);for(rowsToSave=1;rowsToSave<n;rowsToSave++){let n=e.rows[rowsToSave].cells[1].innerHTML.replaceAll(" ","");t=t+rowsToSave+","+n+","+e.rows[rowsToSave].cells[2].innerHTML+","+e.rows[rowsToSave].cells[3].innerHTML+","+e.rows[rowsToSave].cells[4].innerHTML+","+e.rows[rowsToSave].cells[5].innerHTML+","+e.rows[rowsToSave].cells[6].innerHTML+","+e.rows[rowsToSave].cells[7].innerHTML+","+e.rows[rowsToSave].cells[8].innerHTML+"\n"}const o=new Blob([t],{type:"text/csv;charset=utf-8"});saveAs(o,"myfile.csv")}monthIS.onchange=(e=>{showR1()});var rIndex,cIndex,tableGJournal=document.getElementById("GeneralJournal"),indexC=document.getElementById("CurrentIndex"),myrow=1,mybackuprow=1,myrowI=0,editFlag=0;for(tableGJournal=document.getElementById("GeneralJournal"),row=0;row<250;row++){for(tr=document.createElement("tr"),cell=0;cell<9;cell++)td=document.createElement("td"),tr.appendChild(td),0==cell&&(td.style.width="25px",td.innerHTML="<mark>&#x1F6C8</mark>"+row),cell>0&&(td.style.width="120px"),cell>4&&(td.style.width="200px"),cell>5&&(td.style.width="40px"),cell>5&&td.classList.add("no_export");tableGJournal.appendChild(tr)}tableGJournal.rows[0].cells[0].innerHTML="Index",tableGJournal.rows[0].cells[1].innerHTML="...........Amount",tableGJournal.rows[0].cells[2].innerHTML="Debit",tableGJournal.rows[0].cells[3].innerHTML="Credit",tableGJournal.rows[0].cells[4].innerHTML="Date",tableGJournal.rows[0].cells[5].innerHTML="Description",tableGJournal.rows[0].cells[6].innerHTML="Class",tableGJournal.rows[0].cells[7].innerHTML="Reference",tableGJournal.rows[0].cells[8].innerHTML="Source";for(i=1;i<tableGJournal.rows.length;i++)for(var j=0;j<tableGJournal.rows[i].cells.length;j++)tableGJournal.rows[i].cells[j].onclick=function(){(rIndex=this.parentElement.rowIndex)<myrow&&(9==(cIndex=this.cellIndex+1)?confirm("Here is your document! "+rIndex):1==cIndex?confirm("More information on transaction "+rIndex+"\n Amount: R"+this.parentElement.cells[1].innerHTML+"\n Debit-account: "+this.parentElement.cells[2].innerHTML+"\n Credit-account: "+this.parentElement.cells[3].innerHTML+"\n Description: "+this.parentElement.cells[5].innerHTML+"\n was captured on: "+this.parentElement.cells[4].innerHTML):(myrow=mybackuprow,1==confirm("Click OK to edit transaction Index = "+rIndex+" or Cancel to continue with a new transaction at Index = "+myrow)&&(myrow=rIndex,editFlag=1,document.getElementById("Amount").value=this.parentElement.cells[1].innerHTML.replaceAll(" ",""),document.getElementById("Debit").value=this.parentElement.cells[2].innerHTML,document.getElementById("Credit").value=this.parentElement.cells[3].innerHTML,document.getElementById("Date").value=this.parentElement.cells[4].innerHTML,document.getElementById("Description").value=this.parentElement.cells[5].innerHTML)))};function myRow(e){myrow=e,mybackuprow=Math.max(mybackuprow,myrow),indexC.innerHTML="Index: "+myrow+" on "}function editRow(e){1==e&&(resetRest(),document.getElementById("Debit").value="Bank",document.getElementById("Credit").value="Cash",document.getElementById("Amount").value=1,document.getElementById("Description").value=".",myrow=ij+1,mybackuprow=Math.max(mybackuprow,myrow)),csv=document.getElementById("email").value,name=document.getElementById("password").value;let t=name+csv;console.log(t);let n=t.substring(0,8)+t.substring(8,11);console.log(n);let o=hash(n,!1,0);var a=0;document.getElementById("Debit").value!=document.getElementById("Credit").value&&""!=document.getElementById("Debit").value&&""!=document.getElementById("Credit").value||(alert("Your debit account and credit account cannot be empty or be the same."),a=1),""==document.getElementById("Description").value&&(alert("Your description cannot be empty."),a=1),document.getElementById("Amount").value<=0&&(alert("Your amount must be positive!  1. Negative amounts in Asset accounts are entered as positive in the Credit column of the Asset account.  2. Negative amounts in the Income Statement accounts, Liabilities and Owner's Equity accounts are entered as positive in the Debit column of those accounts. "),a=1),marsDef.includes(o)||(alert("Register your email on the form at : \n 'https://forms.gle/ezpegueioNh1e9Ly9' and then re-visit the webpage.\n. Reserved for registered users."),a=1,console.log(o)),o.length<5&&(alert("Your email is too short: "),csv="No-user",a=1),0==a&&editRow4Real(0,myrow)}function editRow4Real(e,t){if(indexC.innerHTML="Index: "+myrow+" on ",inputText="Show **T-Account Ledger(select an account)",y.innerHTML=inputText,1==e&&(myrow=t),"object"==typeof(d1=new Date)&&null!==d1&&"getDate"in d1)var n=d1.getDate(),o=Mname[d1.getMonth()],a=d1.getFullYear();1!=editFlag&&0!=e||(AmountList[myrow]=document.getElementById("Amount").value,DebitList[myrow]=document.getElementById("Debit").value,CreditList[myrow]=document.getElementById("Credit").value,DateList[myrow]=n+" "+o+" "+a,DescriptionList[myrow]=document.getElementById("Description").value,ClassList[myrow]=document.getElementById("Class").value,ReferenceList[myrow]=document.getElementById("Refe").value,SourceList[myrow]=document.getElementById("Source").value),AmountList[myrow]=100*AmountList[myrow],tableGJournal.rows[myrow].cells[1].innerHTML=number_format(AmountList[myrow]/100,2,"."," "),tableGJournal.rows[myrow].cells[2].innerHTML=DebitList[myrow],tableGJournal.rows[myrow].cells[3].innerHTML=CreditList[myrow],tableGJournal.rows[myrow].cells[4].innerHTML=DateList[myrow],tableGJournal.rows[myrow].cells[5].innerHTML=DescriptionList[myrow],tableGJournal.rows[myrow].cells[6].innerHTML=ClassList[myrow],tableGJournal.rows[myrow].cells[7].innerHTML=ReferenceList[myrow],tableGJournal.rows[myrow].cells[8].innerHTML=SourceList[myrow]+"<mark>&#x1F6C8</mark>";var l=myrow,s=document.getElementById("showIndx").value;let r=parseInt(s);r<l&&(l=r),tableGJournal.rows[l].scrollIntoView({behavior:"smooth",block:"center"}),resetAccounts(),emptyTablesA(),document.getElementById("Amount").value="",document.getElementById("Debit").value="",document.getElementById("Credit").value="",document.getElementById("Date").value="",document.getElementById("Description").value="",myrow=parseInt(myrow)+1,mybackuprow=Math.max(mybackuprow,myrow),updateStatements(),updateTotals(),CreditList[myrow-1],CreditCorr[myrow-2],DebitList[myrow-1],DebitCorr[myrow-2];AmountList[myrow-1],AmountCorr[myrow-2];indexC.innerHTML="Index: "+parseInt(myrow)+" on ",1==editFlag&&(editFlag=0,myrow=mybackuprow)}function updateStatements(){myrow=mybackuprow,NumberOfTransactions=AmountList.length,PreviousTrans=1==DescriptionList.includes("End of Accounting Period")?DescriptionList.lastIndexOf("End of Accounting Period"):1,myrowI>0&&(NumShow=myrowI),0==myrowI&&(NumShow=NumberOfTransactions);var e=document.getElementById("showIndx").value;let t=parseInt(e);t+1<NumShow&&(NumShow=t+1);for(let e=1;e<NumShow;e++)if("End of Accounting Period"==DescriptionList[e])endPeriodAccounts2();else for(let t=0;t<B1.length;t++)if(DebitList[e]==statementsAccounts[B1[t]]&&(accountTotals[B1[t]]=accountTotals[B1[t]]+parseFloat(AmountList[e]),B1[t]>146&&(accountTotals[145]=accountTotals[145]+parseFloat(AmountList[e]),tableOE.rows[5].cells[2].innerHTML=number_format(accountTotals[145]/100,2,"."," ")),updateTotals(),updateTablesD(t,e)),CreditList[e]==statementsAccounts[B1[t]]&&(accountTotals[B1[t]]=accountTotals[B1[t]]-parseFloat(AmountList[e]),B1[t]>146&&(accountTotals[145]=accountTotals[145]-parseFloat(AmountList[e])),updateTotals(),updateTablesC(t,e)),B1[t]>146){accountTotals[153]=accountTotals[147]+accountTotals[149],accountTotals[156]=accountTotals[153]+accountTotals[154],accountTotals[159]=accountTotals[156]+accountTotals[157],accountTotals[163]=accountTotals[159]+accountTotals[162],accountTotals[165]=accountTotals[163]+accountTotals[164]}}function updateStatementsI(){NumberOfTransactions=myrowI,1==DescriptionList.includes("End of Accounting Period")?(PreviousTrans=DescriptionList.lastIndexOf("End of Accounting Period"),console.log(PreviousTrans+"End of APeriod"),console.log(accountTotals[147]),console.log(accountTotalsEOP[147])):PreviousTrans=1,myrowI>0&&(NumShow=myrowI),0==myrowI&&(NumShow=NumberOfTransactions),NumShow=NumberOfTransactions;for(let e=1;e<NumShow;e++)if("End of Accounting Period"==DescriptionList[e])endPeriodAccounts2();else for(let t=0;t<B1.length;t++)if(DebitList[e]==statementsAccounts[B1[t]]&&(accountTotals[B1[t]]=accountTotals[B1[t]]+parseFloat(AmountList[e]),B1[t]>146&&(accountTotals[145]=accountTotals[145]+parseFloat(AmountList[e]),tableOE.rows[5].cells[2].innerHTML=number_format(accountTotals[145]/100,2,"."," ")),updateTotals(),updateTablesD(t,e)),CreditList[e]==statementsAccounts[B1[t]]&&(accountTotals[B1[t]]=accountTotals[B1[t]]-parseFloat(AmountList[e]),B1[t]>146&&(accountTotals[145]=accountTotals[145]-parseFloat(AmountList[e])),updateTotals(),updateTablesC(t,e)),B1[t]>146){accountTotals[153]=accountTotals[147]+accountTotals[149],accountTotals[156]=accountTotals[153]+accountTotals[154],accountTotals[159]=accountTotals[156]+accountTotals[157],accountTotals[163]=accountTotals[159]+accountTotals[162],accountTotals[165]=accountTotals[163]+accountTotals[164]}}function updateTablesD(e,t){if(B1[e]>146){var n=e-O1L+1;accountTotals[B1[e]]-accountTotalsEOP[B1[e]]>0&&(tableIS.rows[n].cells[1].innerHTML=number_format((accountTotals[B1[e]]-accountTotalsEOP[B1[e]])/100,2,"."," "),tableIS.rows[n].cells[2].innerHTML=""),accountTotals[B1[e]]-accountTotalsEOP[B1[e]]<0&&(tableIS.rows[n].cells[1].innerHTML="",tableIS.rows[n].cells[2].innerHTML=number_format((-accountTotals[B1[e]]+accountTotalsEOP[B1[e]])/100,2,"."," ")),accountTotals[B1[e]]-accountTotalsEOP[B1[e]]==0&&(tableIS.rows[n].cells[1].innerHTML="",tableIS.rows[n].cells[2].innerHTML="")}if(B1[e]<18){accountTotals[1]=accountTotals[1]+parseFloat(AmountList[t]);var o=e+1;accountTotals[B1[e]]>0&&(tableAssets.rows[o].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableAssets.rows[o].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableAssets.rows[o].cells[1].innerHTML="",tableAssets.rows[o].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableAssets.rows[o].cells[1].innerHTML="",tableAssets.rows[o].cells[2].innerHTML="")}if(B1[e]>17&&B1[e]<100){o=e+1;accountTotals[18]=accountTotals[18]+parseFloat(AmountList[t]),accountTotals[B1[e]]>0&&(tableAssets.rows[o].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableAssets.rows[o].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableAssets.rows[o].cells[1].innerHTML="",tableAssets.rows[o].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableAssets.rows[o].cells[1].innerHTML="",tableAssets.rows[o].cells[2].innerHTML="")}if(B1[e]>99&&B1[e]<134){n=e-B10L+1;accountTotals[129]=accountTotals[129]+parseFloat(AmountList[t]),accountTotals[B1[e]]>0&&(tableLiab.rows[n].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableLiab.rows[n].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableLiab.rows[n].cells[1].innerHTML="",tableLiab.rows[n].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableLiab.rows[n].cells[1].innerHTML="",tableLiab.rows[n].cells[2].innerHTML="")}if(B1[e]>133&&B1[e]<137){n=e-B10L+1;accountTotals[134]=accountTotals[134]+parseFloat(AmountList[t]),accountTotals[B1[e]]>0&&(tableLiab.rows[n].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableLiab.rows[n].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableLiab.rows[n].cells[1].innerHTML="",tableLiab.rows[n].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableLiab.rows[n].cells[1].innerHTML="",tableLiab.rows[n].cells[2].innerHTML="")}if(B1[e]>138&&B1[e]<144){n=e-L1L+1;accountTotals[138]=accountTotals[138]+parseFloat(AmountList[t]),accountTotals[B1[e]]>0&&(tableOE.rows[n].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableOE.rows[n].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableOE.rows[n].cells[1].innerHTML="",tableOE.rows[n].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableOE.rows[n].cells[1].innerHTML="",tableOE.rows[n].cells[2].innerHTML="")}if(B1[e]>143&&B1[e]<147){n=e-L1L+1;accountTotals[B1[e]]>0&&(tableOE.rows[n].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableOE.rows[n].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableOE.rows[n].cells[1].innerHTML="",tableOE.rows[n].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableOE.rows[n].cells[1].innerHTML="",tableOE.rows[n].cells[2].innerHTML="")}}function updateTablesC(e,t){if(B1[e]>146){var n=e-O1L+1;accountTotals[B1[e]]-accountTotalsEOP[B1[e]]>0&&(tableIS.rows[n].cells[1].innerHTML=number_format((accountTotals[B1[e]]-accountTotalsEOP[B1[e]])/100,2,"."," "),tableIS.rows[n].cells[2].innerHTML=""),accountTotals[B1[e]]-accountTotalsEOP[B1[e]]<0&&(tableIS.rows[n].cells[1].innerHTML="",tableIS.rows[n].cells[2].innerHTML=number_format((-accountTotals[B1[e]]+accountTotalsEOP[B1[e]])/100,2,"."," ")),accountTotals[B1[e]]-accountTotalsEOP[B1[e]]==0&&(tableIS.rows[n].cells[1].innerHTML="",tableIS.rows[n].cells[2].innerHTML="")}if(B1[e]<18){var o=e+1;accountTotals[1]=accountTotals[1]-parseFloat(AmountList[t]),accountTotals[B1[e]]>0&&(tableAssets.rows[o].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableAssets.rows[o].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableAssets.rows[o].cells[1].innerHTML="",tableAssets.rows[o].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableAssets.rows[o].cells[1].innerHTML="",tableAssets.rows[o].cells[2].innerHTML="")}if(B1[e]>17&&B1[e]<100){accountTotals[18]=accountTotals[18]-parseFloat(AmountList[t]);o=e+1;accountTotals[B1[e]]>0&&(tableAssets.rows[o].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableAssets.rows[o].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableAssets.rows[o].cells[1].innerHTML="",tableAssets.rows[o].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableAssets.rows[o].cells[1].innerHTML="",tableAssets.rows[o].cells[2].innerHTML="")}if(B1[e]>99&&B1[e]<134){n=e-B10L+1;accountTotals[129]=accountTotals[129]-parseFloat(AmountList[t]),accountTotals[B1[e]]>0&&(tableLiab.rows[n].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableLiab.rows[n].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableLiab.rows[n].cells[1].innerHTML="",tableLiab.rows[n].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableLiab.rows[n].cells[1].innerHTML="",tableLiab.rows[n].cells[2].innerHTML="")}if(B1[e]>133&&B1[e]<137){n=e-B10L+1;accountTotals[134]=accountTotals[134]-parseFloat(AmountList[t]),accountTotals[B1[e]]>0&&(tableLiab.rows[n].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableLiab.rows[n].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableLiab.rows[n].cells[1].innerHTML="",tableLiab.rows[n].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableLiab.rows[n].cells[1].innerHTML="",tableLiab.rows[n].cells[2].innerHTML="")}if(B1[e]>138&&B1[e]<144){n=e-L1L+1;accountTotals[138]=accountTotals[139]+accountTotals[140],accountTotals[B1[e]]>0&&(tableOE.rows[n].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableOE.rows[n].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableOE.rows[n].cells[1].innerHTML="",tableOE.rows[n].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableOE.rows[n].cells[1].innerHTML="",tableOE.rows[n].cells[2].innerHTML="")}if(B1[e]>143&&B1[e]<147){n=e-L1L+1;accountTotals[B1[e]]>0&&(tableOE.rows[n].cells[1].innerHTML=number_format(accountTotals[B1[e]]/100,2,"."," "),tableOE.rows[n].cells[2].innerHTML=""),accountTotals[B1[e]]<0&&(tableOE.rows[n].cells[1].innerHTML="",tableOE.rows[n].cells[2].innerHTML=number_format(-accountTotals[B1[e]]/100,2,"."," ")),0==accountTotals[B1[e]]&&(tableOE.rows[n].cells[1].innerHTML="",tableOE.rows[n].cells[2].innerHTML="")}}function updateTotals(){accountTotals[153]=accountTotals[147]+accountTotals[149],accountTotals[156]=accountTotals[153]+accountTotals[154]+accountTotals[155],accountTotals[159]=accountTotals[156]+accountTotals[157],accountTotals[163]=accountTotals[159]+accountTotals[160]+accountTotals[161],accountTotals[165]=accountTotals[163]+accountTotals[164],accountTotals[138]=accountTotals[139]+accountTotals[140],accountTotals[137]=accountTotals[138]+accountTotals[144]+accountTotals[145],accountTotals[128]=accountTotals[129]+accountTotals[134],accountTotals[146]=accountTotals[128]+accountTotals[137],accountTotals[0]=accountTotals[1]+accountTotals[18],tableIS.rows[13].cells[2].innerHTML=number_format((-accountTotals[165]+accountTotalsEOP[165])/100,2,"."," "),tableIS.rows[6].cells[2].innerHTML=number_format((-accountTotals[156]+accountTotalsEOP[156])/100,2,"."," "),tableIS.rows[8].cells[2].innerHTML=number_format((-accountTotals[159]+accountTotalsEOP[159])/100,2,"."," "),tableIS.rows[3].cells[2].innerHTML=number_format((-accountTotals[153]+accountTotalsEOP[153])/100,2,"."," "),tableIS.rows[11].cells[2].innerHTML=number_format((-accountTotals[163]+accountTotalsEOP[163])/100,2,"."," "),tableIS.rows[1].cells[2].innerHTML=number_format((-accountTotals[147]+accountTotalsEOP[147])/100,2,"."," "),tableAssets.rows[1].cells[1].innerHTML=number_format(accountTotals[0]/100,2,"."," "),tableAssets.rows[2].cells[1].innerHTML=number_format(accountTotals[1]/100,2,"."," "),tableAssets.rows[10].cells[1].innerHTML=number_format(accountTotals[18]/100,2,"."," "),tableLiab.rows[1].cells[2].innerHTML=number_format(-accountTotals[128]/100,2,"."," "),tableLiab.rows[2].cells[2].innerHTML=number_format(-accountTotals[129]/100,2,"."," "),tableLiab.rows[7].cells[2].innerHTML=number_format(-accountTotals[134]/100,2,"."," "),tableOE.rows[1].cells[2].innerHTML=number_format(-accountTotals[137]/100,2,"."," "),tableOE.rows[2].cells[2].innerHTML=number_format(-accountTotals[138]/100,2,"."," "),tableOE.rows[6].cells[2].innerHTML=number_format(-accountTotals[146]/100,2,"."," "),tableOE.rows[5].cells[2].innerHTML=number_format(-accountTotals[145]/100,2,"."," ");for(var e=0;e<35;e++)e>ledger.rows.length-1&&(ledger.rows[e].cells[0].innerHTML=" ");window.scrollTo(0,0),showR1(),showR2();var t=myrow,n=document.getElementById("showIndx").value;let o=parseInt(n);o<t&&(t=o),tableGJournal.rows[t].scrollIntoView({block:"center"}),cash.rows[1].cells[2].innerHTML=number_format(-accountTotals[165]/100,2,"."," ");var a=accountTotals[157]-accountTotalsEOP[157];cash.rows[3].cells[2].innerHTML=number_format(a/100,2,"."," ");var l=accountTotals[130]+accountTotals[131]+accountTotals[132]+accountTotals[133]-(accountTotalsEOP[130]+accountTotalsEOP[131]+accountTotalsEOP[132]+accountTotalsEOP[133]);cash.rows[4].cells[2].innerHTML=number_format(-l/100,2,"."," "),cash.rows[6].cells[1].innerHTML=number_format((accountTotals[16]-accountTotalsEOP[16])/100,2,"."," ");var s=accountTotals[11]+accountTotals[13]+accountTotals[14]+accountTotals[6]-(accountTotalsEOP[11]+accountTotalsEOP[13]+accountTotalsEOP[14]+accountTotalsEOP[6]);cash.rows[7].cells[1].innerHTML=number_format(s/100,2,"."," ");var r=-accountTotals[165]+(accountTotals[157]-accountTotalsEOP[157])-l-(accountTotals[16]-accountTotalsEOP[16])-s;cash.rows[8].cells[2].innerHTML="<b>"+number_format(r/100,2,"."," ");var c=accountTotals[20]+accountTotals[22]-accountTotalsEOP[20]-accountTotalsEOP[22]+a;cash.rows[10].cells[1].innerHTML=number_format(c/100,2,"."," ");var i=-accountTotals[135]-accountTotals[138]+accountTotalsEOP[135]+accountTotalsEOP[138];cash.rows[12].cells[2].innerHTML=number_format(i/100,2,"."," ");var u=r-c+i;cash.rows[13].cells[2].innerHTML="<b>"+number_format(u/100,2,"."," "),window.scrollTo(0,0)}function endPeriodAccounts(){if(PreviousTrans=myrow,myrow+=1,mybackuprow=Math.max(mybackuprow,myrow),accountTotalsEOP[147]=accountTotals[147],accountTotalsEOP[148]=accountTotals[148],accountTotalsEOP[149]=accountTotals[149],accountTotalsEOP[150]=accountTotals[150],accountTotalsEOP[151]=accountTotals[151],accountTotalsEOP[152]=accountTotals[152],accountTotalsEOP[153]=accountTotals[153],accountTotalsEOP[154]=accountTotals[154],accountTotalsEOP[155]=accountTotals[155],accountTotalsEOP[156]=accountTotals[156],accountTotalsEOP[157]=accountTotals[157],accountTotalsEOP[158]=accountTotals[158],accountTotalsEOP[159]=accountTotals[159],accountTotalsEOP[160]=accountTotals[160],accountTotalsEOP[161]=accountTotals[161],accountTotalsEOP[162]=accountTotals[162],accountTotalsEOP[163]=accountTotals[163],accountTotalsEOP[164]=accountTotals[164],accountTotalsEOP[165]=accountTotals[165],accountTotalsEOP[166]=accountTotals[166],DebitList[PreviousTrans]="---",CreditList[PreviousTrans]="---",AmountList[PreviousTrans]="---","object"==typeof(d1=new Date)&&null!==d1&&"getDate"in d1)var e=d1.getDate(),t=Mname[d1.getMonth()],n=d1.getFullYear();DateList[myrow]=e+" "+t+" "+n,DescriptionList[PreviousTrans]="End of Accounting Period",tableGJournal.rows[PreviousTrans].cells[1].innerHTML="---",tableGJournal.rows[PreviousTrans].cells[2].innerHTML=DebitList[PreviousTrans],tableGJournal.rows[PreviousTrans].cells[3].innerHTML=CreditList[PreviousTrans],tableGJournal.rows[PreviousTrans].cells[4].innerHTML=DateList[myrow],tableGJournal.rows[PreviousTrans].cells[5].innerHTML=DescriptionList[PreviousTrans],tableIS.rows[1].cells[1].innerHTML="",tableIS.rows[1].cells[2].innerHTML="",tableIS.rows[2].cells[1].innerHTML="",tableIS.rows[2].cells[2].innerHTML="",tableIS.rows[3].cells[1].innerHTML="",tableIS.rows[3].cells[2].innerHTML="",tableIS.rows[4].cells[1].innerHTML="",tableIS.rows[4].cells[2].innerHTML="",tableIS.rows[5].cells[1].innerHTML="",tableIS.rows[5].cells[2].innerHTML="",tableIS.rows[6].cells[1].innerHTML="",tableIS.rows[6].cells[2].innerHTML="",tableIS.rows[7].cells[1].innerHTML="",tableIS.rows[7].cells[2].innerHTML="",tableIS.rows[8].cells[1].innerHTML="",tableIS.rows[8].cells[2].innerHTML="",tableIS.rows[9].cells[1].innerHTML="",tableIS.rows[9].cells[2].innerHTML="",tableIS.rows[10].cells[1].innerHTML="",tableIS.rows[10].cells[2].innerHTML="",tableIS.rows[11].cells[1].innerHTML="",tableIS.rows[11].cells[2].innerHTML="",tableIS.rows[12].cells[1].innerHTML="",tableIS.rows[12].cells[2].innerHTML="",tableIS.rows[13].cells[1].innerHTML="",tableIS.rows[13].cells[2].innerHTML="",PreviousTrans=1}function endPeriodAccounts2(){accountTotalsEOP[147]=accountTotals[147],accountTotalsEOP[148]=accountTotals[148],accountTotalsEOP[149]=accountTotals[149],accountTotalsEOP[150]=accountTotals[150],accountTotalsEOP[151]=accountTotals[151],accountTotalsEOP[152]=accountTotals[152],accountTotalsEOP[153]=accountTotals[153],accountTotalsEOP[154]=accountTotals[154],accountTotalsEOP[155]=accountTotals[155],accountTotalsEOP[156]=accountTotals[156],accountTotalsEOP[157]=accountTotals[157],accountTotalsEOP[158]=accountTotals[158],accountTotalsEOP[159]=accountTotals[159],accountTotalsEOP[160]=accountTotals[160],accountTotalsEOP[161]=accountTotals[161],accountTotalsEOP[162]=accountTotals[162],accountTotalsEOP[163]=accountTotals[163],accountTotalsEOP[164]=accountTotals[164],accountTotalsEOP[165]=accountTotals[165],accountTotalsEOP[166]=accountTotals[166],tableIS.rows[1].cells[1].innerHTML="",tableIS.rows[1].cells[2].innerHTML="",tableIS.rows[2].cells[1].innerHTML="",tableIS.rows[2].cells[2].innerHTML="",tableIS.rows[3].cells[1].innerHTML="",tableIS.rows[3].cells[2].innerHTML="",tableIS.rows[4].cells[1].innerHTML="",tableIS.rows[4].cells[2].innerHTML="",tableIS.rows[5].cells[1].innerHTML="",tableIS.rows[5].cells[2].innerHTML="",tableIS.rows[6].cells[1].innerHTML="",tableIS.rows[6].cells[2].innerHTML="",tableIS.rows[7].cells[1].innerHTML="",tableIS.rows[7].cells[2].innerHTML="",tableIS.rows[8].cells[1].innerHTML="",tableIS.rows[8].cells[2].innerHTML="",tableIS.rows[9].cells[1].innerHTML="",tableIS.rows[9].cells[2].innerHTML="",tableIS.rows[10].cells[1].innerHTML="",tableIS.rows[10].cells[2].innerHTML="",tableIS.rows[11].cells[1].innerHTML="",tableIS.rows[11].cells[2].innerHTML="",tableIS.rows[12].cells[1].innerHTML="",tableIS.rows[12].cells[2].innerHTML="",tableIS.rows[13].cells[1].innerHTML="",tableIS.rows[13].cells[2].innerHTML="",PreviousTrans=1}function emptyTablesB(){for(e=1;e<250;e++)for(k=1;k<6;k++)tableGJournal.rows[e].cells[k].innerHTML=""}function emptyTablesA(){for(e=1;e<14;e++)tableAssets.rows[e].cells[1].innerHTML="",tableAssets.rows[e].cells[2].innerHTML="";for(e=1;e<9;e++)tableLiab.rows[e].cells[1].innerHTML="",tableLiab.rows[e].cells[2].innerHTML="";for(e=1;e<7;e++)tableOE.rows[e].cells[1].innerHTML="",tableOE.rows[e].cells[2].innerHTML="";for(e=1;e<14;e++)tableIS.rows[e].cells[1].innerHTML="",tableIS.rows[e].cells[2].innerHTML=""}function hash(e,t,n){var o,a,l=void 0===n?2166136261:n;for(o=0,a=e.length;o<a;o++)l^=e.charCodeAt(o),l+=(l<<1)+(l<<4)+(l<<7)+(l<<8)+(l<<24);return t?("0000000"+(l>>>0).toString(16)).substr(-8):l>>>0}function number_format(e,t,n,o){var a=isFinite(+e)?+e:0,l=isFinite(+t)?Math.abs(t):0,s=void 0===o?" ":o,r=void 0===n?".":n,c=(l?function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}(a,l):Math.round(a)).toString().split(".");return c[0].length>3&&(c[0]=c[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),(c[1]||"").length<l&&(c[1]=c[1]||"",c[1]+=new Array(l-c[1].length+1).join("0")),c.join(r)}window.scrollTo(0,0);let GeneralLedger={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13",14:"14",15:"15",16:"16",17:"17",18:"18",19:"19",20:"20",21:"21",22:"22",23:"23",24:"24",25:"25",26:"26",27:"27",28:"28",29:"29",30:"30",31:"31",32:"32",33:"33",34:"34",35:"35",36:"36",37:"37",38:"38",39:"39",40:"40",41:"41",42:"42",43:"43",44:"44",45:"45",46:"46",47:"47",48:"48",49:"49",50:"50",51:"51",52:"52",53:"53",54:"54",55:"55",56:"56",57:"57",58:"58",59:"59",60:"60",61:"61",62:"62",63:"63",64:"64",65:"65",66:"66",67:"67",68:"68",69:"69",70:"70",71:"71",72:"72",73:"73",74:"74",75:"75",76:"76",77:"77",78:"78",79:"79",80:"80",81:"81",82:"82",83:"83",84:"84",85:"85",86:"86",87:"87",88:"88",89:"89",90:"90",91:"91",92:"92",93:"93",94:"94",95:"95",96:"96",97:"97",98:"98",99:"99",100:"CURRENTASSETS",101:"Cash",102:"Cheque",103:"Savings",104:"_PrepaidExpenses",105:"Prepaidtaxes",106:"Payrollfund",107:"Dividendfund",108:"Taxfund",109:"",110:"OpeningInventory",111:"Purchases:RawMaterial1",112:"Purchases:RawMaterial2",113:"113",114:"114",115:"115",116:"116",117:"117",118:"118",119:"119",120:"WIPInventory",121:"121",122:"122",123:"123",124:"124",125:"125",126:"126",127:"127",128:"128",129:"129",130:"TradeInventory-1",131:"TradeInventory-2",132:"132",133:"133",134:"134",135:"135",136:"136",137:"137",138:"138",139:"139",140:"AccountsReceivable",141:"Allowancefordoubtfulaccounts",142:"142",143:"143",144:"144",145:"145",146:"146",147:"147",148:"148",149:"149",150:"NONCURRENTASSETS",151:"151",152:"152",153:"153",154:"154",155:"155",156:"156",157:"157",158:"158",159:"159",160:"Plant,PropertyandEquipment",161:"Land",162:"Building",163:"Machinery",164:"Vehicles",165:"OfficeEquipment",166:"Furnitureandfixtures",167:"167",168:"168",169:"Accumulateddepreciation",170:"Long-termloanto:",171:"171",172:"172",173:"173",174:"174",175:"175",176:"176",177:"177",178:"178",179:"179",180:"180",181:"181",182:"182",183:"183",184:"184",185:"185",186:"186",187:"187",188:"188",189:"189",190:"190",191:"191",192:"192",193:"193",194:"194",195:"195",196:"196",197:"197",198:"198",199:"TOTALASSETS",200:"CURRENTLIABILITIES",201:"AccountsPayable",202:"Provisionforcurrenttax",203:"Shorttermborrowings",204:"Dividendsdeclaredpayable",205:"UnearnedRevenue(pre-paidrevenue)",206:"ProvisionforDepreciation",207:"207",208:"208",209:"209",210:"210",211:"211",212:"212",213:"213",214:"214",215:"215",216:"216",217:"217",218:"218",219:"219",220:"220",221:"221",222:"222",223:"223",224:"224",225:"225",226:"226",227:"227",228:"228",229:"229",230:"230",231:"231",232:"232",233:"233",234:"234",235:"235",236:"236",237:"237",238:"238",239:"239",240:"240",241:"241",242:"242",243:"243",244:"244",245:"245",246:"246",247:"247",248:"248",249:"249",250:"NONCURRENTLIABILITIES",251:"Longtermloan",252:"Hire-Purchaselongterm",253:"253",254:"254",255:"255",256:"256",257:"257",258:"258",259:"259",260:"260",261:"261",262:"262",263:"263",264:"264",265:"265",266:"266",267:"267",268:"268",269:"269",270:"270",271:"271",272:"272",273:"273",274:"274",275:"275",276:"276",277:"277",278:"278",279:"279",280:"280",281:"281",282:"282",283:"283",284:"284",285:"285",286:"286",287:"287",288:"288",289:"289",290:"290",291:"291",292:"292",293:"293",294:"294",295:"295",296:"296",297:"297",298:"298",299:"TOTALLIABILITIES",300:"OwnerEquity(inc.Retained)",301:"Capitalaccounts",302:"Jamey",303:"Susan",304:"Jay",305:"Jack",306:"Jill",307:"307",308:"308",309:"309",310:"310",311:"311",312:"312",313:"313",314:"314",315:"315",316:"316",317:"317",318:"318",319:"319",320:"320",321:"321",322:"322",323:"323",324:"324",325:"325",326:"326",327:"327",328:"328",329:"329",330:"330",331:"331",332:"332",333:"333",334:"334",335:"335",336:"336",337:"337",338:"338",339:"339",340:"340",341:"341",342:"342",343:"343",344:"344",345:"345",346:"346",347:"347",348:"348",349:"349",350:"350",351:"351",352:"352",353:"353",354:"354",355:"355",356:"356",357:"357",358:"358",359:"359",360:"360",361:"361",362:"362",363:"363",364:"364",365:"365",366:"366",367:"367",368:"368",369:"369",370:"370",371:"371",372:"372",373:"373",374:"374",375:"375",376:"376",377:"377",378:"378",379:"379",380:"380",381:"381",382:"382",383:"383",384:"384",385:"385",386:"386",387:"387",388:"388",389:"389",390:"Dividentstobepaid",391:"391",392:"392",393:"393",394:"394",395:"395",396:"396",397:"397",398:"RetainedEarnings",399:"TotalLiabilities+OwnersEquity",400:"SalesorRevenues",401:"SalesReturns",402:"402",403:"403",404:"404",405:"405",406:"406",407:"407",408:"408",409:"409",410:"410",411:"411",412:"412",413:"413",414:"414",415:"415",416:"416",417:"417",418:"418",419:"419",420:"420",421:"421",422:"422",423:"423",424:"424",425:"425",426:"426",427:"427",428:"428",429:"429",430:"430",431:"431",432:"432",433:"433",434:"434",435:"435",436:"436",437:"437",438:"438",439:"439",440:"440",441:"441",442:"442",443:"443",444:"444",445:"445",446:"446",447:"447",448:"448",449:"449",450:"450",451:"451",452:"452",453:"453",454:"454",455:"455",456:"456",457:"457",458:"458",459:"459",460:"460",461:"461",462:"462",463:"463",464:"464",465:"465",466:"466",467:"467",468:"468",469:"469",470:"470",471:"471",472:"472",473:"473",474:"474",475:"475",476:"476",477:"477",478:"478",479:"479",480:"480",481:"481",482:"482",483:"483",484:"484",485:"485",486:"486",487:"487",488:"488",489:"489",490:"490",491:"491",492:"492",493:"493",494:"494",495:"495",496:"496",497:"497",498:"498",499:"499",500:"COGS",501:"COGR",502:"502",503:"503",504:"504",505:"505",506:"506",507:"507",508:"508",509:"509",510:"510",511:"511",512:"512",513:"513",514:"514",515:"515",516:"516",517:"517",518:"518",519:"519",520:"520",521:"521",522:"522",523:"523",524:"524",525:"525",526:"526",527:"527",528:"528",529:"529",530:"530",531:"531",532:"532",533:"533",534:"534",535:"535",536:"536",537:"537",538:"538",539:"539",540:"540",541:"541",542:"542",543:"543",544:"544",545:"545",546:"546",547:"547",548:"548",549:"549",550:"550",551:"551",552:"552",553:"553",554:"554",555:"555",556:"556",557:"557",558:"558",559:"559",560:"560",561:"561",562:"562",563:"563",564:"564",565:"565",566:"566",567:"567",568:"568",569:"569",570:"570",571:"571",572:"572",573:"573",574:"574",575:"575",576:"576",577:"577",578:"578",579:"579",580:"580",581:"581",582:"582",583:"583",584:"584",585:"585",586:"586",587:"587",588:"588",589:"589",590:"590",591:"591",592:"592",593:"593",594:"594",595:"595",596:"596",597:"597",598:"598",599:"599",600:"FixedCost",601:"601",602:"602",603:"603",604:"604",605:"605",606:"606",607:"607",608:"608",609:"609",610:"610",611:"611",612:"612",613:"613",614:"614",615:"615",616:"616",617:"617",618:"618",619:"619",620:"620",621:"621",622:"622",623:"623",624:"624",625:"625",626:"626",627:"627",628:"628",629:"629",630:"630",631:"631",632:"632",633:"633",634:"634",635:"635",636:"636",637:"637",638:"638",639:"639",640:"640",641:"641",642:"642",643:"643",644:"644",645:"645",646:"646",647:"647",648:"648",649:"649",650:"650",651:"651",652:"652",653:"653",654:"654",655:"655",656:"656",657:"657",658:"658",659:"659",660:"660",661:"661",662:"662",663:"663",664:"664",665:"665",666:"666",667:"667",668:"668",669:"669",670:"670",671:"671",672:"672",673:"673",674:"674",675:"675",676:"676",677:"677",678:"678",679:"679",680:"680",681:"681",682:"682",683:"683",684:"684",685:"685",686:"686",687:"687",688:"688",689:"689",690:"690",691:"691",692:"692",693:"693",694:"694",695:"695",696:"696",697:"697",698:"698",699:"699",700:"700",701:"701",702:"702",703:"703",704:"704",705:"705",706:"706",707:"707",708:"708",709:"709",710:"710",711:"711",712:"712",713:"713",714:"714",715:"715",716:"716",717:"717",718:"718",719:"719",720:"720",721:"721",722:"722",723:"723",724:"724",725:"725",726:"726",727:"727",728:"728",729:"729",730:"730",731:"731",732:"732",733:"733",734:"734",735:"735",736:"736",737:"737",738:"738",739:"739",740:"740",741:"741",742:"742",743:"743",744:"744",745:"745",746:"746",747:"747",748:"748",749:"749",750:"750",751:"751",752:"752",753:"753",754:"754",755:"755",756:"756",757:"757",758:"758",759:"759",760:"760",761:"761",762:"762",763:"763",764:"764",765:"765",766:"766",767:"767",768:"768",769:"769",770:"770",771:"771",772:"772",773:"773",774:"774",775:"775",776:"776",777:"777",778:"778",779:"779",780:"780",781:"781",782:"782",783:"783",784:"784",785:"785",786:"786",787:"787",788:"788",789:"789",790:"790",791:"791",792:"792",793:"793",794:"794",795:"795",796:"796",797:"797",798:"798",799:"DiscountsAllowed",800:"OtherExpenses",801:"DiscountsRecieved",802:"OtherIncome",803:"803",804:"804",805:"805",806:"806",807:"807",808:"808",809:"809",810:"810",811:"811",812:"812",813:"813",814:"814",815:"815",816:"816",817:"817",818:"818",819:"819",820:"820",821:"821",822:"822",823:"823",824:"824",825:"825",826:"826",827:"827",828:"828",829:"829",830:"830",831:"831",832:"832",833:"833",834:"834",835:"835",836:"836",837:"837",838:"838",839:"839",840:"840",841:"841",842:"842",843:"843",844:"844",845:"845",846:"846",847:"847",848:"848",849:"EBITDA",850:"Depreciation",851:"Amortisation",852:"852",853:"853",854:"854",855:"855",856:"856",857:"857",858:"858",859:"859",860:"860",861:"861",862:"862",863:"863",864:"864",865:"865",866:"866",867:"867",868:"868",869:"869",870:"870",871:"871",872:"872",873:"873",874:"874",875:"875",876:"876",877:"877",878:"878",879:"879",880:"880",881:"881",882:"882",883:"883",884:"884",885:"885",886:"886",887:"887",888:"888",889:"889",890:"890",891:"891",892:"892",893:"893",894:"894",895:"895",896:"896",897:"897",898:"898",899:"899",900:"900",901:"901",902:"902",903:"903",904:"904",905:"905",906:"906",907:"907",908:"908",909:"909",910:"910",911:"911",912:"912",913:"913",914:"914",915:"915",916:"916",917:"917",918:"918",919:"919",920:"920",921:"921",922:"922",923:"923",924:"924",925:"925",926:"926",927:"927",928:"928",929:"929",930:"930",931:"931",932:"932",933:"933",934:"934",935:"935",936:"936",937:"937",938:"938",939:"939",940:"940",941:"941",942:"942",943:"943",944:"944",945:"945",946:"946",947:"947",948:"948",949:"949",950:"EBIT",951:"Interestpaid",952:"Interestreceived",953:"InterestBalance",954:"954",955:"955",956:"956",957:"957",958:"958",959:"959",960:"EBT",961:"961",962:"962",963:"963",964:"964",965:"965",966:"966",967:"967",968:"968",969:"969",970:"Taxpaid",971:"971",972:"972",973:"973",974:"974",975:"975",976:"976",977:"977",978:"978",979:"979",980:"980",981:"981",982:"982",983:"983",984:"984",985:"985",986:"986",987:"987",988:"988",989:"989",990:"990",991:"991",992:"992",993:"993",994:"994",995:"995",996:"996",997:"997",998:"NetProfit",999:"Dividends"};
